<!DOCTYPE html>
<html>
<head>
    <title>Course Connections</title>
    <p>-by MRZ</p>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body {
            font-family: sans-serif;
            margin: 20px;
        }

        #course-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            grid-gap: 20px;
        }

        .course-block.alternative {
            background-color: #ce93d8; /* Light purple */
            color: #512da8;
        }

        .course-block.course5 {
            background-color: #ffcdd2; /* Light red */
            color: #c62828; /* Darker red */
        }

        .course-card {
            border: 1px solid #ccc;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.1);
            background-color: #f9f9f9;
        }

        .alternative {
            color: red;
        }

        .course5 {
            color: purple;
        }

        .color-key {
            margin-top: 20px;
            border: 1px solid #ccc;
            padding: 10px;
            border-radius: 5px;
        }

        .color-key span {
            display: inline-block;
            width: 20px;
            height: 20px;
            margin-right: 5px;
            border-radius: 50%;
        }

        .color-key .red-key {
            background-color: red;
        }

        .color-key .purple-key {
            background-color: purple;
        }

        .controls {
            margin: 20px 0;
        }

        #person-details {
            margin-top: 30px;
        }

        .person-card {
            border: 1px solid #ccc;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.1);
            background: #fff;
        }

        .person-card h3 {
            margin: 0 0 10px;
            color: #333;
            font-size: 1.2em;
        }

        .person-card p {
            margin: 5px 0;
            color: #555;
        }

        .course-block {
            display: inline-block;
            background: #e0f7fa;
            color: #00796b;
            padding: 5px 10px;
            margin: 5px 5px 5px 0;
            border-radius: 5px;
            font-size: 0.9em;
        }

        .course-block.alternative {
            background-color: #ce93d8; /* Light purple */
            color: #512da8; /* Darker purple */
        }

        .course-block.course5 {
            background-color: #ffcdd2; /* Light red */
            color: #c62828; /* Darker red */
        }


        .common-list {
            margin: 10px 0 0;
            padding: 0;
            list-style: none;
        }

        .common-list li {
            margin-bottom: 10px;
            font-size: 0.95em;
        }

        .common-course {
            color: #007BFF;
            display: inline-block;
            background: #e3f2fd;
            padding: 5px 10px;
            border-radius: 5px;
            margin: 3px 5px;
        }
    </style>
</head>
<body>
    <h1>Course Connections</h1>
    <div class="controls">
        <button id="sort-courses">Sort Courses</button>
    </div>
    <div id="course-list"></div>
    <div id="person-details"></div>

    <script>
         fetch('course_data.json')
            .then(response => response.json())
            .then(jsonData => {
                const courseData = jsonData;

                const courseListDiv = document.getElementById('course-list');
                const personDetailsDiv = document.getElementById('person-details');

                function displayCourses(sorted = false) {
                    courseListDiv.innerHTML = '';

                    const coursePeopleMap = {};
                    courseData.forEach(person => {
                        person.Courses.forEach(course => {
                            if (!coursePeopleMap[course]) {
                                coursePeopleMap[course] = [];
                            }
                            coursePeopleMap[course].push(person.Name);
                        });
                        if (person["Course 5"]) {
                            if (!coursePeopleMap[person["Course 5"]]) {
                                coursePeopleMap[person["Course 5"]] = [];
                            }
                            coursePeopleMap[person["Course 5"]].push(person.Name);
                        }
                        person["Alternative Courses"].forEach(course => {
                            if (!coursePeopleMap[course]) {
                                coursePeopleMap[course] = [];
                            }
                            coursePeopleMap[course].push(person.Name);
                        });
                    });

                    let courses = Object.keys(coursePeopleMap);
                    if (sorted) {
                        courses = courses.sort((a, b) => coursePeopleMap[b].length - coursePeopleMap[a].length);
                    }

                    courses.forEach(course => {
                        const card = document.createElement('div');
                        card.className = 'course-card';
                        card.innerHTML = `<h3>${course}</h3><ul></ul>`;
                        const ul = card.querySelector('ul');
                        coursePeopleMap[course].forEach(person => {
                            const li = document.createElement('li');
                            li.textContent = person;
                            ul.appendChild(li);
                        });
                        courseListDiv.appendChild(card);
                    });
                }

                function displayPersonDetails() {
                    const personCourseMap = {};

                    courseData.forEach(person => {
                        personCourseMap[person.Name] = [...person.Courses];
                        if (person["Course 5"]) {
                            personCourseMap[person.Name].push(person["Course 5"]);
                        }
                        person["Alternative Courses"].forEach(course => {
                            personCourseMap[person.Name].push(course);
                        });
                    });

                                        personDetailsDiv.innerHTML = '<h2>Person Details</h2>';
                    for (const person in personCourseMap) {
                        const courses = personCourseMap[person];
                        const commonCourses = Object.keys(personCourseMap)
                            .filter(otherPerson => otherPerson !== person)
                            .map(otherPerson => ({
                                name: otherPerson,
                                common: courses.filter(course => personCourseMap[otherPerson]?.includes(course))
                            }))
                            .filter(entry => entry.common.length > 0);

                        const detailsDiv = document.createElement('div');
                        detailsDiv.className = 'person-card';
                        detailsDiv.innerHTML = `
                            <h3>${person}</h3>
                            <p><strong>Courses:</strong></p>
                            <div>
                                ${courses.map(course => {
                                    let classNames = 'course-block';
                                    if (courseData.find(p => p.Name === person && p["Alternative Courses"].includes(course))) {
                                        classNames += ' alternative';
                                    } else if (courseData.find(p => p.Name === person && p["Course 5"] === course)) {
                                        classNames += ' course5';
                                    }
                                    return `<span class="${classNames}">${course}</span>`;
                                }).join('')}
                            </div>
                            ${commonCourses.length > 0 ? '<p><strong>Common Courses:</strong></p>' : ''}
                            <ul class="common-list">
                                ${commonCourses
                                    .map(entry => `
                                        <li>
                                            <strong>${entry.name}</strong>
                                            <div>
                                                ${entry.common.map(course => `<span class="common-course">${course}</span>`).join('')}
                                            </div>
                                        </li>`)
                                    .join('')}
                            </ul>
                        `;
                        personDetailsDiv.appendChild(detailsDiv);
                    }
                }

                displayCourses();
                displayPersonDetails();

                document.getElementById('sort-courses').addEventListener('click', () => {
                    displayCourses(true);
                });
            })
            .catch(error => console.error('Error fetching JSON:', error));
    </script>
</body>
